const _0x2feb00=_0x47f2;(function(_0x544b4e,_0x3d93a9){const _0x5e53ee=_0x47f2,_0x57e23c=_0x544b4e();while(!![]){try{const _0x22318d=parseInt(_0x5e53ee(0x251))/0x1*(parseInt(_0x5e53ee(0x22a))/0x2)+parseInt(_0x5e53ee(0x249))/0x3+parseInt(_0x5e53ee(0x1ea))/0x4*(parseInt(_0x5e53ee(0x22b))/0x5)+parseInt(_0x5e53ee(0x23e))/0x6*(parseInt(_0x5e53ee(0x206))/0x7)+-parseInt(_0x5e53ee(0x220))/0x8+parseInt(_0x5e53ee(0x20c))/0x9*(parseInt(_0x5e53ee(0x1d3))/0xa)+-parseInt(_0x5e53ee(0x225))/0xb*(parseInt(_0x5e53ee(0x1da))/0xc);if(_0x22318d===_0x3d93a9)break;else _0x57e23c['push'](_0x57e23c['shift']());}catch(_0x5938b7){_0x57e23c['push'](_0x57e23c['shift']());}}}(_0x27ad,0xa7cf0));import _0x1788a9 from'express';import _0xfdde2c from'mongoose';import _0x5a1656 from'node-fetch';import _0x121f5e from'node-cron';import _0x42511b from'crypto';const app=_0x1788a9(),PORT=process['env'][_0x2feb00(0x233)]||0xbb8,CHANNEL_ID='1485854';await _0xfdde2c['connect'](_0x2feb00(0x211),{'useNewUrlParser':!![],'useUnifiedTopology':!![]});const messageSchema=new _0xfdde2c[(_0x2feb00(0x1ff))]({'username':{'type':String,'unique':!![]},'messageCount':{'type':Number,'default':0x0}}),Message=_0xfdde2c[_0x2feb00(0x1d2)](_0x2feb00(0x1d9),messageSchema),previousLeaderboardSchema=new _0xfdde2c[(_0x2feb00(0x1ff))]({'entries':[{'username':{'type':String,'required':!![]},'messageCount':{'type':Number,'required':!![]},'rank':{'type':Number,'required':!![]}}],'resetDate':{'type':Date,'default':Date[_0x2feb00(0x20d)]},'weekNumber':{'type':Number,'required':!![]}}),PreviousLeaderboard=_0xfdde2c['model'](_0x2feb00(0x1f3),previousLeaderboardSchema),rollSchema=new _0xfdde2c[(_0x2feb00(0x1ff))]({'winner':{'type':String,'required':!![]},'prize':{'type':Number,'required':!![]},'timestamp':{'type':Date,'default':Date['now']},'serverSeed':{'type':String,'required':!![]},'clientSeed':{'type':String,'required':!![]},'nonce':{'type':Number,'required':!![]},'hash':{'type':String,'required':!![]}}),Roll=_0xfdde2c[_0x2feb00(0x1d2)](_0x2feb00(0x1e7),rollSchema);let lastSeenMessageId=null;const userLastMessages=new Map(),IGNORED_USERS=[_0x2feb00(0x232),_0x2feb00(0x23f)];let nextRollTime=null,rollInterval=null,serverSeed=generateServerSeed(),nonce=0x0;function generateServerSeed(){const _0x3a59ad=_0x2feb00;return Math[_0x3a59ad(0x24a)]()[_0x3a59ad(0x246)](0x24)[_0x3a59ad(0x236)](0x2,0xf)+Math[_0x3a59ad(0x24a)]()[_0x3a59ad(0x246)](0x24)['substring'](0x2,0xf);}async function sha256(_0x1bcaf8){const _0x5f1948=_0x2feb00;return _0x42511b[_0x5f1948(0x218)](_0x5f1948(0x1f5))[_0x5f1948(0x237)](_0x1bcaf8)['digest'](_0x5f1948(0x1dd));}async function generateRoll(_0x530f43,_0x20a57a,_0x34270e){const _0x467df9=_0x2feb00,_0x4a2851=_0x530f43+'-'+_0x20a57a+'-'+_0x34270e,_0x9cc7e5=await sha256(_0x4a2851);return parseInt(_0x9cc7e5[_0x467df9(0x236)](0x0,0x8),0x10)/Math[_0x467df9(0x24d)](0x2,0x20);}function getNextRollTime(){return getNextResetDate();}async function performRoll(){const _0x54db14=_0x2feb00;try{const _0xabc99d=await Message[_0x54db14(0x21e)]()[_0x54db14(0x1f9)]({'messageCount':-0x1})['limit'](0xf)[_0x54db14(0x229)]();if(_0xabc99d[_0x54db14(0x24e)]===0x0){console[_0x54db14(0x221)]('No\x20users\x20available\x20for\x20roll');return;}console[_0x54db14(0x221)]('Top\x20users\x20entered\x20into\x20the\x20roll:'),_0xabc99d[_0x54db14(0x226)]((_0x35d7bf,_0x52e082)=>{const _0x2a1e49=_0x54db14;console[_0x2a1e49(0x221)]('#'+(_0x52e082+0x1)+':\x20'+_0x35d7bf[_0x2a1e49(0x22f)]+'\x20('+_0x35d7bf['messageCount']+_0x2a1e49(0x1e0));});const _0x350169=Date[_0x54db14(0x20d)]()[_0x54db14(0x246)](),_0x2e6000=await generateRoll(serverSeed,_0x350169,nonce),_0xac1bf=Math['floor'](_0x2e6000*_0xabc99d['length']),_0x174987=_0xabc99d[_0xac1bf],_0x2a2958=new Roll({'winner':_0x174987['username'],'prize':0xa,'serverSeed':serverSeed,'clientSeed':_0x350169,'nonce':nonce,'hash':await sha256(serverSeed+'-'+_0x350169+'-'+nonce)});await _0x2a2958[_0x54db14(0x1df)](),console[_0x54db14(0x221)](_0x54db14(0x243)+_0x174987[_0x54db14(0x22f)]+_0x54db14(0x22c)),nonce++,nextRollTime=getNextRollTime();}catch(_0x2bcb1d){console[_0x54db14(0x209)](_0x54db14(0x200),_0x2bcb1d);}}function getNextResetDate(){const _0x200a7d=_0x2feb00,_0x46f926=new Date(),_0x1efa92=new Date(0x7e9,0x6,0x1,0x0,0x0,0x0,0x0);if(_0x46f926<_0x1efa92)return _0x1efa92;const _0x21db60=_0x46f926[_0x200a7d(0x224)]()-_0x1efa92[_0x200a7d(0x224)](),_0x261ef9=Math['floor'](_0x21db60/(0x7*0x18*0x3c*0x3c*0x3e8))+0x1,_0x10511a=new Date(_0x1efa92[_0x200a7d(0x224)]()+_0x261ef9*0x7*0x18*0x3c*0x3c*0x3e8);return _0x10511a[_0x200a7d(0x1ec)](_0x10511a['getHours']()+0x2),_0x10511a;}async function resetLeaderboard(){const _0x50d3ea=_0x2feb00;try{const _0x2c02f5=await Message[_0x50d3ea(0x21e)]()[_0x50d3ea(0x1f9)]({'messageCount':-0x1})['limit'](0x64)[_0x50d3ea(0x229)](),_0x753f5=new Date();_0x753f5['setDate'](_0x753f5[_0x50d3ea(0x24f)]()+0x1);const _0x12efc1=new Date(_0x753f5[_0x50d3ea(0x216)](),_0x753f5[_0x50d3ea(0x20f)](),_0x753f5[_0x50d3ea(0x24f)](),0x0,0x0,0x0,0x0),_0x2ec36d=new Date(),_0x4437b4=_0x2ec36d[_0x50d3ea(0x224)]()-_0x12efc1[_0x50d3ea(0x224)](),_0x436c54=Math['floor'](_0x4437b4/(0x7*0x18*0x3c*0x3c*0x3e8))+0x1;if(_0x2c02f5[_0x50d3ea(0x24e)]>0x0){const _0x1cfa8e=_0x2c02f5['map']((_0x59bd9a,_0x1e37aa)=>({'username':_0x59bd9a['username'],'messageCount':_0x59bd9a['messageCount'],'rank':_0x1e37aa+0x1})),_0xbfabbd=new PreviousLeaderboard({'entries':_0x1cfa8e,'resetDate':new Date(),'weekNumber':_0x436c54});await _0xbfabbd[_0x50d3ea(0x1df)](),console[_0x50d3ea(0x221)](_0x50d3ea(0x248)+_0x1cfa8e['length']+_0x50d3ea(0x234)+_0x436c54);}await Message[_0x50d3ea(0x24b)]({}),lastSeenMessageId=null,userLastMessages['clear'](),serverSeed=generateServerSeed(),nonce=0x0,nextRollTime=getNextRollTime(),console[_0x50d3ea(0x221)](_0x50d3ea(0x247)+_0x436c54+'\x20completed');}catch(_0x2b7eba){console[_0x50d3ea(0x209)](_0x50d3ea(0x202),_0x2b7eba);}}async function checkAndResetIfOverdue(){const _0x337565=_0x2feb00,_0x67878a=new Date(),_0x5a093b=getNextResetDate();_0x67878a>=_0x5a093b&&(console[_0x337565(0x221)](_0x337565(0x231)),await resetLeaderboard(),await performRoll());}app[_0x2feb00(0x213)]('/timer',(_0x10faab,_0x362906)=>{const _0x450f0d=_0x2feb00,_0x99d4cf=getNextResetDate(),_0x59e523=new Date(),_0x39375a=_0x99d4cf['getTime']()-_0x59e523[_0x450f0d(0x224)]();console[_0x450f0d(0x221)](_0x450f0d(0x21d)+_0x59e523[_0x450f0d(0x208)]()),console[_0x450f0d(0x221)](_0x450f0d(0x1e5)+_0x99d4cf[_0x450f0d(0x208)]()),console[_0x450f0d(0x221)](_0x450f0d(0x214)+_0x39375a);const _0x3da260=Math['floor'](_0x39375a/(0x3e8*0x3c*0x3c*0x18)),_0x12a8d9=Math['floor'](_0x39375a%(0x3e8*0x3c*0x3c*0x18)/(0x3e8*0x3c*0x3c)),_0x17a9e1=Math[_0x450f0d(0x212)](_0x39375a%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x960bdc=Math['floor'](_0x39375a%(0x3e8*0x3c)/0x3e8);console[_0x450f0d(0x221)]('Timer\x20display:\x20'+_0x3da260+'d\x20'+_0x12a8d9+':'+_0x17a9e1+':'+_0x960bdc),_0x362906[_0x450f0d(0x245)]({'timeLeft':Math[_0x450f0d(0x238)](0x0,_0x39375a),'days':_0x3da260,'hours':_0x12a8d9,'minutes':_0x17a9e1,'seconds':_0x960bdc,'nextReset':_0x99d4cf[_0x450f0d(0x208)]()});}),app['get']('/roll-info',async(_0x2e4fb4,_0x46b74c)=>{const _0x38e0bf=_0x2feb00;try{const _0x3978b3=getNextResetDate(),_0x3a884c=new Date(),_0x2970fb=_0x3978b3[_0x38e0bf(0x224)]()-_0x3a884c[_0x38e0bf(0x224)](),_0x43846c=await Roll['findOne']()[_0x38e0bf(0x1f9)]({'timestamp':-0x1});_0x46b74c['json']({'nextRollTime':_0x3978b3[_0x38e0bf(0x208)](),'timeUntilRoll':Math[_0x38e0bf(0x238)](0x0,_0x2970fb),'latestRoll':_0x43846c?{'winner':_0x43846c[_0x38e0bf(0x1e3)],'prize':_0x43846c[_0x38e0bf(0x1ed)],'timestamp':_0x43846c['timestamp'],'hash':_0x43846c[_0x38e0bf(0x230)]}:null});}catch(_0x54a8ba){_0x46b74c[_0x38e0bf(0x1f0)](0x1f4)[_0x38e0bf(0x245)]({'error':_0x54a8ba[_0x38e0bf(0x20e)]});}}),app['get'](_0x2feb00(0x250),async(_0x685e7d,_0x3c5194)=>{const _0x3f8798=_0x2feb00;try{const _0x4df40b=await Roll[_0x3f8798(0x21e)]()['sort']({'timestamp':-0x1})[_0x3f8798(0x203)](0xa);_0x3c5194[_0x3f8798(0x245)](_0x4df40b[_0x3f8798(0x1e1)](_0xd3abc0=>({'winner':_0xd3abc0[_0x3f8798(0x1e3)],'prize':_0xd3abc0[_0x3f8798(0x1ed)],'timestamp':_0xd3abc0[_0x3f8798(0x1e8)],'hash':_0xd3abc0[_0x3f8798(0x230)]})));}catch(_0x1d9f63){_0x3c5194[_0x3f8798(0x1f0)](0x1f4)[_0x3f8798(0x245)]({'error':_0x1d9f63[_0x3f8798(0x20e)]});}}),app[_0x2feb00(0x213)]('/current-seed',(_0x1bf4fa,_0x46cb11)=>{const _0x117b8a=_0x2feb00;_0x46cb11[_0x117b8a(0x245)]({'serverSeed':serverSeed,'nextRollTime':nextRollTime?nextRollTime[_0x117b8a(0x208)]():null});});function isSpamMessage(_0x3e138c,_0x43aa63,_0x8487a3){const _0x5f0d30=_0x2feb00,_0x15737a=_0x43aa63[_0x5f0d30(0x1d4)]();if(!_0x15737a)return!![];if(/^\[emote:\d+:[^\]]+\]$/[_0x5f0d30(0x207)](_0x15737a))return!![];if(_0x15737a[_0x5f0d30(0x24e)]<=0x2)return!![];const _0x4fba66=_0x15737a['replace'](/[^A-Za-z]/g,'');if(_0x4fba66['length']>=0x6){const _0x75e515=(_0x4fba66[_0x5f0d30(0x1e9)](/[A-Z]/g)||[])['length'];if(_0x75e515/_0x4fba66['length']>0.8)return!![];}const _0x163755=userLastMessages['get'](_0x3e138c);if(_0x163755){if(_0x163755['content']===_0x15737a)return!![];if(similarity(_0x163755[_0x5f0d30(0x23d)],_0x15737a)>0.9)return!![];if(_0x8487a3-_0x163755[_0x5f0d30(0x1e8)]<0x3e8)return!![];}return userLastMessages[_0x5f0d30(0x1f6)](_0x3e138c,{'content':_0x15737a,'timestamp':_0x8487a3}),![];}function similarity(_0x31caca,_0x51d32f){const _0x762b1b=_0x2feb00,_0x43c93f=new Set(_0x31caca['toLowerCase']()[_0x762b1b(0x1f4)](/\s+/)),_0x52f30c=new Set(_0x51d32f['toLowerCase']()[_0x762b1b(0x1f4)](/\s+/)),_0x5dc633=new Set([..._0x43c93f][_0x762b1b(0x1d5)](_0xbf452c=>_0x52f30c[_0x762b1b(0x22d)](_0xbf452c)));return _0x5dc633[_0x762b1b(0x23a)]/Math['max'](_0x43c93f['size'],_0x52f30c[_0x762b1b(0x23a)]);}app[_0x2feb00(0x213)](_0x2feb00(0x1fa),async(_0x448e01,_0x1026a6)=>{const _0x1b6d1b=_0x2feb00,_0x6dfd66=await Message[_0x1b6d1b(0x21e)]()['sort']({'messageCount':-0x1})['limit'](0x64)['lean']();_0x1026a6[_0x1b6d1b(0x245)](_0x6dfd66[_0x1b6d1b(0x1e1)](_0x2c81c9=>({'username':_0x2c81c9[_0x1b6d1b(0x22f)],'messageCount':_0x2c81c9[_0x1b6d1b(0x1e2)]})));}),app[_0x2feb00(0x213)]('/previous-leaderboard',async(_0x3f20bd,_0x4da96c)=>{const _0x1bd85e=_0x2feb00;try{const _0x421312=await PreviousLeaderboard[_0x1bd85e(0x1e4)]()[_0x1bd85e(0x1f9)]({'resetDate':-0x1})[_0x1bd85e(0x229)]();if(!_0x421312)return _0x4da96c[_0x1bd85e(0x245)]({'entries':[],'resetDate':null,'weekNumber':null,'message':_0x1bd85e(0x228)});_0x4da96c[_0x1bd85e(0x245)]({'entries':_0x421312['entries'],'resetDate':_0x421312[_0x1bd85e(0x244)],'weekNumber':_0x421312[_0x1bd85e(0x242)]});}catch(_0x4e724a){_0x4da96c['status'](0x1f4)[_0x1bd85e(0x245)]({'error':_0x4e724a[_0x1bd85e(0x20e)]});}}),app[_0x2feb00(0x213)]('/live-status',async(_0x132e95,_0x3e8fbc)=>{const _0x28b2ef=_0x2feb00;try{const _0x2c749c=await isStreamerLive();_0x3e8fbc[_0x28b2ef(0x245)]({'isLive':_0x2c749c});}catch(_0x46e87c){_0x3e8fbc[_0x28b2ef(0x1f0)](0x1f4)[_0x28b2ef(0x245)]({'error':_0x46e87c[_0x28b2ef(0x20e)]});}});async function isStreamerLive(){const _0x13ba71=_0x2feb00;try{const _0x3346de=await _0x5a1656(_0x13ba71(0x1dc));if(!_0x3346de['ok'])return![];const _0x412602=await _0x3346de[_0x13ba71(0x245)]();return _0x412602[_0x13ba71(0x1db)]&&_0x412602[_0x13ba71(0x1db)][_0x13ba71(0x23c)];}catch(_0x190ede){return console[_0x13ba71(0x209)](_0x13ba71(0x240),_0x190ede[_0x13ba71(0x20e)]),![];}}async function pollKickMessages(){const _0x113750=_0x2feb00;try{const _0x357cf4=await isStreamerLive();if(!_0x357cf4){console[_0x113750(0x221)](_0x113750(0x205));return;}const _0x22a8e1=_0x113750(0x239)+CHANNEL_ID+'/messages',_0x43b28d=await _0x5a1656(_0x22a8e1,{'headers':{'User-Agent':_0x113750(0x222)}});if(!_0x43b28d['ok']){console[_0x113750(0x209)](_0x113750(0x20a),await _0x43b28d[_0x113750(0x22e)]());return;}const _0x27dfd5=await _0x43b28d[_0x113750(0x245)](),_0x475aee=(_0x27dfd5[_0x113750(0x20b)]?.['messages']||[])[_0x113750(0x1f9)]((_0x2ee8af,_0x366684)=>new Date(_0x2ee8af['created_at'])-new Date(_0x366684[_0x113750(0x219)]));for(const _0x15bbcc of _0x475aee){if(lastSeenMessageId===_0x15bbcc['id'])break;const _0x518b17=_0x15bbcc[_0x113750(0x1d8)]?.[_0x113750(0x22f)],_0x3e0174=_0x15bbcc[_0x113750(0x23d)],_0x44e165=new Date(_0x15bbcc[_0x113750(0x219)])['getTime']();if(!_0x518b17||!_0x3e0174)continue;if(IGNORED_USERS[_0x113750(0x1fb)](_0x518b17))continue;if(isSpamMessage(_0x518b17,_0x3e0174,_0x44e165))continue;await Message[_0x113750(0x21f)]({'username':_0x518b17},{'$inc':{'messageCount':0x1}},{'upsert':!![]});}_0x475aee[_0x113750(0x24e)]&&(lastSeenMessageId=_0x475aee[_0x475aee[_0x113750(0x24e)]-0x1]['id']);}catch(_0x439e6d){console[_0x113750(0x209)](_0x113750(0x215),_0x439e6d[_0x113750(0x20e)]);}}function _0x47f2(_0x5bbcfb,_0x5270ea){const _0x27ad48=_0x27ad();return _0x47f2=function(_0x47f2e2,_0x9fc149){_0x47f2e2=_0x47f2e2-0x1d2;let _0x42775c=_0x27ad48[_0x47f2e2];return _0x42775c;},_0x47f2(_0x5bbcfb,_0x5270ea);}((async()=>{const _0x114d76=_0x2feb00;await checkAndResetIfOverdue();try{const _0x47231f=await _0x5a1656(_0x114d76(0x239)+CHANNEL_ID+_0x114d76(0x217),{'headers':{'User-Agent':_0x114d76(0x222)}}),_0x466f36=await _0x47231f[_0x114d76(0x245)](),_0x22609a=_0x466f36['data']?.[_0x114d76(0x201)]||[];_0x22609a['length']&&(lastSeenMessageId=_0x22609a[_0x22609a['length']-0x1]['id']);}catch(_0x2e191a){}setInterval(pollKickMessages,0x3e8);})()),_0x121f5e[_0x2feb00(0x24c)](_0x2feb00(0x1f1),async()=>{const _0x26dd68=_0x2feb00;try{const _0x2d1d80=new Date(),_0x1e751b=new Date(0x7e9,0x6,0x1,0x0,0x0,0x0,0x0);if(_0x2d1d80>=_0x1e751b){const _0x1e764b=_0x2d1d80[_0x26dd68(0x224)]()-_0x1e751b[_0x26dd68(0x224)](),_0x35529a=Math[_0x26dd68(0x212)](_0x1e764b/(0x7*0x18*0x3c*0x3c*0x3e8)),_0x2f3464=new Date(_0x1e751b[_0x26dd68(0x224)]()+(_0x35529a+0x1)*0x7*0x18*0x3c*0x3c*0x3e8),_0x1c5fb1=Math[_0x26dd68(0x1eb)](_0x2d1d80[_0x26dd68(0x224)]()-_0x2f3464[_0x26dd68(0x224)]()),_0x4fa5f5=0x3c*0x3c*0x3e8;_0x1c5fb1<=_0x4fa5f5?(console[_0x26dd68(0x221)](_0x26dd68(0x210)),console['log']('Current\x20time:\x20'+_0x2d1d80['toISOString']()),console[_0x26dd68(0x221)](_0x26dd68(0x241)+_0x2f3464[_0x26dd68(0x208)]()),await resetLeaderboard(),await performRoll()):console[_0x26dd68(0x221)]('⏰\x20Not\x20time\x20for\x20reset\x20yet.\x20Current:\x20'+_0x2d1d80[_0x26dd68(0x208)]()+_0x26dd68(0x1f8)+_0x2f3464['toISOString']());}else console[_0x26dd68(0x221)](_0x26dd68(0x1fc)+_0x2d1d80[_0x26dd68(0x208)]()+',\x20First\x20reset:\x20'+_0x1e751b['toISOString']());}catch(_0x122a00){console['error'](_0x26dd68(0x21b),_0x122a00);}},{'timezone':'UTC'}),((()=>{const _0x38a1db=_0x2feb00;nextRollTime=getNextRollTime(),console[_0x38a1db(0x221)](_0x38a1db(0x1fd)+nextRollTime);})()),app['use'](_0x1788a9[_0x2feb00(0x227)](_0x2feb00(0x223))),app[_0x2feb00(0x1ef)](_0x1788a9[_0x2feb00(0x245)]()),app[_0x2feb00(0x21c)](_0x2feb00(0x21a),async(_0xe7c3f1,_0x860b0c)=>{const _0x304dce=_0x2feb00;try{const {winner:_0xc34e3d,prize:_0x29f11f,timestamp:_0x160b27}=_0xe7c3f1[_0x304dce(0x1d6)],_0x5df84c=new Roll({'winner':_0xc34e3d,'prize':_0x29f11f,'timestamp':_0x160b27?new Date(_0x160b27):new Date(),'serverSeed':_0x304dce(0x1ee),'clientSeed':'manual','nonce':0x0,'hash':_0x304dce(0x1ee)});await _0x5df84c[_0x304dce(0x1df)](),_0x860b0c[_0x304dce(0x245)]({'success':!![]});}catch(_0x2f2bf1){_0x860b0c[_0x304dce(0x1f0)](0x1f4)['json']({'error':_0x2f2bf1[_0x304dce(0x20e)]});}}),app[_0x2feb00(0x21c)]('/test-save-leaderboard',async(_0x54c47c,_0x23be69)=>{const _0x44ec67=_0x2feb00;try{const _0x4ab038=await Message['find']()[_0x44ec67(0x1f9)]({'messageCount':-0x1})[_0x44ec67(0x203)](0x64)['lean'](),_0x51c01c=new Date();_0x51c01c[_0x44ec67(0x1f7)](_0x51c01c['getDate']()+0x1);const _0x1caeb6=new Date(_0x51c01c[_0x44ec67(0x216)](),_0x51c01c[_0x44ec67(0x20f)](),_0x51c01c[_0x44ec67(0x24f)](),0x0,0x0,0x0,0x0),_0x1f6a9e=new Date(),_0x190bfd=_0x1f6a9e[_0x44ec67(0x224)]()-_0x1caeb6[_0x44ec67(0x224)](),_0x1f589b=Math[_0x44ec67(0x212)](_0x190bfd/(0x7*0x18*0x3c*0x3c*0x3e8))+0x1;if(_0x4ab038[_0x44ec67(0x24e)]>0x0){const _0x5ec02c=_0x4ab038[_0x44ec67(0x1e1)]((_0x391f8b,_0x5ac450)=>({'username':_0x391f8b[_0x44ec67(0x22f)],'messageCount':_0x391f8b[_0x44ec67(0x1e2)],'rank':_0x5ac450+0x1})),_0x16619a=new PreviousLeaderboard({'entries':_0x5ec02c,'resetDate':new Date(),'weekNumber':_0x1f589b});await _0x16619a['save'](),console['log'](_0x44ec67(0x23b)+_0x5ec02c[_0x44ec67(0x24e)]+_0x44ec67(0x1e6)+_0x1f589b),_0x23be69['json']({'success':!![],'message':_0x44ec67(0x1f2)+_0x5ec02c[_0x44ec67(0x24e)]+_0x44ec67(0x234)+_0x1f589b,'entries':_0x5ec02c[_0x44ec67(0x235)](0x0,0xa),'weekNumber':_0x1f589b});}else _0x23be69['json']({'success':![],'message':_0x44ec67(0x1de)});}catch(_0x5f77c9){console[_0x44ec67(0x209)](_0x44ec67(0x1d7),_0x5f77c9),_0x23be69[_0x44ec67(0x1f0)](0x1f4)[_0x44ec67(0x245)]({'error':_0x5f77c9[_0x44ec67(0x20e)]});}}),app[_0x2feb00(0x1fe)](PORT,()=>console['log'](_0x2feb00(0x204)+PORT));function _0x27ad(){const _0x282326=['PORT','\x20entries\x20for\x20week\x20','slice','substring','update','max','https://kick.com/api/v2/channels/','size','Test\x20save\x20completed:\x20','is_live','content','8136svHcfb','KickBot','Live\x20check\x20failed:','Expected\x20reset:\x20','weekNumber','Roll\x20completed!\x20Winner:\x20','resetDate','json','toString','Leaderboard\x20reset\x20-\x20Week\x20','Previous\x20leaderboard\x20saved\x20with\x20','1508601nokmwZ','random','deleteMany','schedule','pow','length','getDate','/roll-history','256933AtsxJK','model','30GnqnJX','trim','filter','body','Error\x20in\x20test\x20save:','sender','Message','38239476BuiiZw','livestream','https://kick.com/api/v1/channels/enjayy','hex','No\x20entries\x20to\x20save','save','\x20messages)','map','messageCount','winner','findOne','Next\x20reset:\x20','\x20entries\x20saved\x20for\x20week\x20','Roll','timestamp','match','52NNsssV','abs','setHours','prize','manual','use','status','0\x200\x20*\x20*\x200','Test\x20save\x20completed\x20with\x20','PreviousLeaderboard','split','sha256','set','setDate',',\x20Expected:\x20','sort','/leaderboard','includes','⏳\x20First\x20reset\x20hasn\x27t\x20happened\x20yet.\x20Current:\x20','Next\x20roll\x20scheduled\x20for:\x20','listen','Schema','Error\x20performing\x20roll:','messages','Error\x20resetting\x20leaderboard:','limit','Server\x20on\x20port\x20','Streamer\x20is\x20offline\x20—\x20skipping\x20message\x20polling.','5103yPAzXW','test','toISOString','error','Fetch\x20failed','data','2265867lSMcJh','now','message','getMonth','🔄\x20EXECUTING\x20WEEKLY\x20LEADERBOARD\x20RESET\x20🔄','mongodb+srv://davekekv:C4kxK3SFZkLA2CZe@cluster0.wkodygj.mongodb.net/leaderboardDB?retryWrites=true&w=majority','floor','get','Time\x20left\x20(ms):\x20','Error\x20in\x20pollKickMessages:','getFullYear','/messages','createHash','created_at','/roll-winner','❌\x20Error\x20during\x20weekly\x20reset:','post','Current\x20time:\x20','find','findOneAndUpdate','3431928NPeyZG','log','Mozilla/5.0','public','getTime','11KpATWO','forEach','static','No\x20previous\x20leaderboard\x20found','lean','6dBWYeG','494415PUxipY',',\x20Prize:\x20$10','has','text','username','hash','⏰\x20Overdue\x20leaderboard\x20reset\x20detected.\x20Performing\x20immediate\x20reset.','BotRix'];_0x27ad=function(){return _0x282326;};return _0x27ad();}
