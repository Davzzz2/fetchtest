const _0x293a64=_0x1072;(function(_0xe3c3bb,_0x5ec1f8){const _0x2ff930=_0x1072,_0x89b62f=_0xe3c3bb();while(!![]){try{const _0x698c4d=-parseInt(_0x2ff930(0x1b7))/0x1+-parseInt(_0x2ff930(0x1a8))/0x2+-parseInt(_0x2ff930(0x1cc))/0x3+parseInt(_0x2ff930(0x1ab))/0x4*(parseInt(_0x2ff930(0x1b1))/0x5)+parseInt(_0x2ff930(0x179))/0x6*(parseInt(_0x2ff930(0x1d0))/0x7)+-parseInt(_0x2ff930(0x189))/0x8+parseInt(_0x2ff930(0x1d5))/0x9;if(_0x698c4d===_0x5ec1f8)break;else _0x89b62f['push'](_0x89b62f['shift']());}catch(_0x96b2cb){_0x89b62f['push'](_0x89b62f['shift']());}}}(_0xf00a,0xba5a0));import _0x1f2435 from'express';import _0x2ae065 from'mongoose';import _0x28f809 from'node-fetch';function _0xf00a(){const _0x3aa6af=['sha256','Next\x20roll\x20scheduled\x20for:\x20','clear','timestamp','save','winner','sender','findOneAndUpdate','Error\x20performing\x20roll:','Test\x20save\x20completed:\x20','mongodb+srv://davekekv:C4kxK3SFZkLA2CZe@cluster0.wkodygj.mongodb.net/leaderboardDB?retryWrites=true&w=majority','listen','content','post','public','setDate','Mozilla/5.0','KickBot','substring','map','https://kick.com/api/v1/channels/enjayy','model','PreviousLeaderboard','1727410bkamvl','Next\x20reset:\x20','prize','5047436qOppGr','livestream','pow','Live\x20check\x20failed:','/test-save-leaderboard','created_at','5qxRijt','manual','toLowerCase','/messages','UTC','No\x20entries\x20to\x20save','326836UitBSM','getDate','setHours','0\x200\x20*\x20*\x200',',\x20Prize:\x20$10','env','findOne','connect','/live-status','get','test','Time\x20left\x20(ms):\x20','entries','now','‚ùå\x20Error\x20during\x20weekly\x20reset:','\x20entries\x20saved\x20for\x20week\x20','size','lean','hex','\x20entries\x20for\x20week\x20','messageCount','1756836ottgNB','resetDate','schedule','sort','7oKTnCB','getTime','find','deleteMany','error','6307290mcmBNU','Schema','messages','length','/roll-info','/timer','toString','createHash','/roll-history','weekNumber','Roll','static','/leaderboard','Message','max','Fetch\x20failed','json','username','has','getMonth','status','hash','Test\x20save\x20completed\x20with\x20','Current\x20time:\x20','5258310tLqmZs','limit','floor','log','Previous\x20leaderboard\x20saved\x20with\x20','No\x20previous\x20leaderboard\x20found','use','Error\x20in\x20pollKickMessages:','Error\x20resetting\x20leaderboard:','Leaderboard\x20reset\x20-\x20Week\x20','toISOString','Error\x20in\x20test\x20save:','set','match','getFullYear','split','2396840xuFwLI','message','update','üîÑ\x20EXECUTING\x20WEEKLY\x20LEADERBOARD\x20RESET\x20üîÑ','1485854','is_live','Server\x20on\x20port\x20','BotRix'];_0xf00a=function(){return _0x3aa6af;};return _0xf00a();}function _0x1072(_0x5b25e3,_0x225f5a){const _0xf00a45=_0xf00a();return _0x1072=function(_0x107238,_0x9aa2d4){_0x107238=_0x107238-0x16b;let _0x21121f=_0xf00a45[_0x107238];return _0x21121f;},_0x1072(_0x5b25e3,_0x225f5a);}import _0x23a26e from'node-cron';import _0x593258 from'crypto';const app=_0x1f2435(),PORT=process[_0x293a64(0x1bc)]['PORT']||0xbb8,CHANNEL_ID=_0x293a64(0x18d);await _0x2ae065[_0x293a64(0x1be)](_0x293a64(0x19b),{'useNewUrlParser':!![],'useUnifiedTopology':!![]});const messageSchema=new _0x2ae065['Schema']({'username':{'type':String,'unique':!![]},'messageCount':{'type':Number,'default':0x0}}),Message=_0x2ae065[_0x293a64(0x1a6)](_0x293a64(0x16e),messageSchema),previousLeaderboardSchema=new _0x2ae065[(_0x293a64(0x1d6))]({'entries':[{'username':{'type':String,'required':!![]},'messageCount':{'type':Number,'required':!![]},'rank':{'type':Number,'required':!![]}}],'resetDate':{'type':Date,'default':Date['now']},'weekNumber':{'type':Number,'required':!![]}}),PreviousLeaderboard=_0x2ae065[_0x293a64(0x1a6)](_0x293a64(0x1a7),previousLeaderboardSchema),rollSchema=new _0x2ae065[(_0x293a64(0x1d6))]({'winner':{'type':String,'required':!![]},'prize':{'type':Number,'required':!![]},'timestamp':{'type':Date,'default':Date[_0x293a64(0x1c4)]},'serverSeed':{'type':String,'required':!![]},'clientSeed':{'type':String,'required':!![]},'nonce':{'type':Number,'required':!![]},'hash':{'type':String,'required':!![]}}),Roll=_0x2ae065[_0x293a64(0x1a6)](_0x293a64(0x16b),rollSchema);let lastSeenMessageId=null;const userLastMessages=new Map(),IGNORED_USERS=[_0x293a64(0x190),_0x293a64(0x1a2)];let nextRollTime=null,rollInterval=null,serverSeed=generateServerSeed(),nonce=0x0;function generateServerSeed(){const _0x1aab57=_0x293a64;return Math['random']()[_0x1aab57(0x1db)](0x24)[_0x1aab57(0x1a3)](0x2,0xf)+Math['random']()[_0x1aab57(0x1db)](0x24)[_0x1aab57(0x1a3)](0x2,0xf);}async function sha256(_0x526aa5){const _0x56668f=_0x293a64;return _0x593258[_0x56668f(0x1dc)](_0x56668f(0x191))[_0x56668f(0x18b)](_0x526aa5)['digest'](_0x56668f(0x1c9));}async function generateRoll(_0x3a98fc,_0x2f7424,_0x17fb67){const _0x1cc0d5=_0x293a64,_0x3cd6af=_0x3a98fc+'-'+_0x2f7424+'-'+_0x17fb67,_0x38b870=await sha256(_0x3cd6af);return parseInt(_0x38b870['substring'](0x0,0x8),0x10)/Math[_0x1cc0d5(0x1ad)](0x2,0x20);}function getNextRollTime(){return getNextResetDate();}async function performRoll(){const _0x551df0=_0x293a64;try{const _0x58dc4e=await Message[_0x551df0(0x1d2)]()['sort']({'messageCount':-0x1})[_0x551df0(0x17a)](0xa)[_0x551df0(0x1c8)]();if(_0x58dc4e[_0x551df0(0x1d8)]===0x0){console[_0x551df0(0x17c)]('No\x20users\x20available\x20for\x20roll');return;}const _0x27392f=Date['now']()[_0x551df0(0x1db)](),_0xf467c=await generateRoll(serverSeed,_0x27392f,nonce),_0x2997f2=Math[_0x551df0(0x17b)](_0xf467c*_0x58dc4e[_0x551df0(0x1d8)]),_0xc6531a=_0x58dc4e[_0x2997f2],_0x49554f=new Roll({'winner':_0xc6531a[_0x551df0(0x172)],'prize':0xa,'serverSeed':serverSeed,'clientSeed':_0x27392f,'nonce':nonce,'hash':await sha256(serverSeed+'-'+_0x27392f+'-'+nonce)});await _0x49554f[_0x551df0(0x195)](),console['log']('Roll\x20completed!\x20Winner:\x20'+_0xc6531a['username']+_0x551df0(0x1bb)),nonce++,nextRollTime=getNextRollTime();}catch(_0x434567){console[_0x551df0(0x1d4)](_0x551df0(0x199),_0x434567);}}function getNextResetDate(){const _0x3dae90=_0x293a64,_0x4f5328=new Date(),_0x39cf5c=new Date(0x7e9,0x6,0x1,0x0,0x0,0x0,0x0);if(_0x4f5328<_0x39cf5c)return _0x39cf5c;const _0x3cdb2e=_0x4f5328['getTime']()-_0x39cf5c[_0x3dae90(0x1d1)](),_0x572286=Math[_0x3dae90(0x17b)](_0x3cdb2e/(0x7*0x18*0x3c*0x3c*0x3e8))+0x1,_0x1fbf90=new Date(_0x39cf5c['getTime']()+_0x572286*0x7*0x18*0x3c*0x3c*0x3e8);return _0x1fbf90[_0x3dae90(0x1b9)](_0x1fbf90['getHours']()+0x2),_0x1fbf90;}async function resetLeaderboard(){const _0x902de7=_0x293a64;try{const _0x397969=await Message[_0x902de7(0x1d2)]()[_0x902de7(0x1cf)]({'messageCount':-0x1})[_0x902de7(0x17a)](0x64)[_0x902de7(0x1c8)](),_0x49f314=new Date();_0x49f314[_0x902de7(0x1a0)](_0x49f314['getDate']()+0x1);const _0x4824da=new Date(_0x49f314[_0x902de7(0x187)](),_0x49f314[_0x902de7(0x174)](),_0x49f314['getDate'](),0x0,0x0,0x0,0x0),_0x57d317=new Date(),_0x12633b=_0x57d317['getTime']()-_0x4824da['getTime'](),_0x4005a7=Math['floor'](_0x12633b/(0x7*0x18*0x3c*0x3c*0x3e8))+0x1;if(_0x397969['length']>0x0){const _0x4a50bf=_0x397969[_0x902de7(0x1a4)]((_0x25ee58,_0x2da87e)=>({'username':_0x25ee58['username'],'messageCount':_0x25ee58[_0x902de7(0x1cb)],'rank':_0x2da87e+0x1})),_0x41ac43=new PreviousLeaderboard({'entries':_0x4a50bf,'resetDate':new Date(),'weekNumber':_0x4005a7});await _0x41ac43['save'](),console[_0x902de7(0x17c)](_0x902de7(0x17d)+_0x4a50bf[_0x902de7(0x1d8)]+_0x902de7(0x1ca)+_0x4005a7);}await Message[_0x902de7(0x1d3)]({}),lastSeenMessageId=null,userLastMessages[_0x902de7(0x193)](),serverSeed=generateServerSeed(),nonce=0x0,nextRollTime=getNextRollTime(),console[_0x902de7(0x17c)](_0x902de7(0x182)+_0x4005a7+'\x20completed');}catch(_0x5402a1){console[_0x902de7(0x1d4)](_0x902de7(0x181),_0x5402a1);}}app[_0x293a64(0x1c0)](_0x293a64(0x1da),(_0x2fc4b6,_0x32228a)=>{const _0xefb7b2=_0x293a64,_0x2d166f=getNextResetDate(),_0x5bc30a=new Date(),_0x5b2afb=_0x2d166f[_0xefb7b2(0x1d1)]()-_0x5bc30a[_0xefb7b2(0x1d1)]();console[_0xefb7b2(0x17c)](_0xefb7b2(0x178)+_0x5bc30a[_0xefb7b2(0x183)]()),console[_0xefb7b2(0x17c)](_0xefb7b2(0x1a9)+_0x2d166f[_0xefb7b2(0x183)]()),console[_0xefb7b2(0x17c)](_0xefb7b2(0x1c2)+_0x5b2afb);const _0x23d5fa=Math[_0xefb7b2(0x17b)](_0x5b2afb/(0x3e8*0x3c*0x3c*0x18)),_0x51c579=Math[_0xefb7b2(0x17b)](_0x5b2afb%(0x3e8*0x3c*0x3c*0x18)/(0x3e8*0x3c*0x3c)),_0x1cbb0e=Math['floor'](_0x5b2afb%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x1bd4ee=Math['floor'](_0x5b2afb%(0x3e8*0x3c)/0x3e8);console[_0xefb7b2(0x17c)]('Timer\x20display:\x20'+_0x23d5fa+'d\x20'+_0x51c579+':'+_0x1cbb0e+':'+_0x1bd4ee),_0x32228a['json']({'timeLeft':Math[_0xefb7b2(0x16f)](0x0,_0x5b2afb),'days':_0x23d5fa,'hours':_0x51c579,'minutes':_0x1cbb0e,'seconds':_0x1bd4ee,'nextReset':_0x2d166f[_0xefb7b2(0x183)]()});}),app['get'](_0x293a64(0x1d9),async(_0x3979f2,_0x14470d)=>{const _0x3f0cb7=_0x293a64;try{const _0x25ea23=getNextResetDate(),_0xea708a=new Date(),_0x17d3f4=_0x25ea23[_0x3f0cb7(0x1d1)]()-_0xea708a[_0x3f0cb7(0x1d1)](),_0x16b49a=await Roll['findOne']()['sort']({'timestamp':-0x1});_0x14470d[_0x3f0cb7(0x171)]({'nextRollTime':_0x25ea23[_0x3f0cb7(0x183)](),'timeUntilRoll':Math[_0x3f0cb7(0x16f)](0x0,_0x17d3f4),'latestRoll':_0x16b49a?{'winner':_0x16b49a[_0x3f0cb7(0x196)],'prize':_0x16b49a[_0x3f0cb7(0x1aa)],'timestamp':_0x16b49a[_0x3f0cb7(0x194)],'hash':_0x16b49a[_0x3f0cb7(0x176)]}:null});}catch(_0x1f1e20){_0x14470d['status'](0x1f4)[_0x3f0cb7(0x171)]({'error':_0x1f1e20[_0x3f0cb7(0x18a)]});}}),app['get'](_0x293a64(0x1dd),async(_0x13a02b,_0x34f6d0)=>{const _0x483efc=_0x293a64;try{const _0x3b8d48=await Roll[_0x483efc(0x1d2)]()[_0x483efc(0x1cf)]({'timestamp':-0x1})[_0x483efc(0x17a)](0xa);_0x34f6d0[_0x483efc(0x171)](_0x3b8d48[_0x483efc(0x1a4)](_0x108766=>({'winner':_0x108766['winner'],'prize':_0x108766[_0x483efc(0x1aa)],'timestamp':_0x108766['timestamp'],'hash':_0x108766[_0x483efc(0x176)]})));}catch(_0x10eb9a){_0x34f6d0['status'](0x1f4)['json']({'error':_0x10eb9a[_0x483efc(0x18a)]});}}),app['get']('/current-seed',(_0x5b77d5,_0x3647e6)=>{const _0x57b986=_0x293a64;_0x3647e6[_0x57b986(0x171)]({'serverSeed':serverSeed,'nextRollTime':nextRollTime?nextRollTime[_0x57b986(0x183)]():null});});function isSpamMessage(_0x597976,_0x3e0a21,_0xa109f9){const _0x5e8492=_0x293a64,_0x4af663=_0x3e0a21['trim']();if(!_0x4af663)return!![];if(/^\[emote:\d+:[^\]]+\]$/[_0x5e8492(0x1c1)](_0x4af663))return!![];if(_0x4af663[_0x5e8492(0x1d8)]<=0x2)return!![];const _0x50f44c=_0x4af663['replace'](/[^A-Za-z]/g,'');if(_0x50f44c[_0x5e8492(0x1d8)]>=0x6){const _0x37d2f6=(_0x50f44c[_0x5e8492(0x186)](/[A-Z]/g)||[])[_0x5e8492(0x1d8)];if(_0x37d2f6/_0x50f44c[_0x5e8492(0x1d8)]>0.8)return!![];}const _0x1dd7a6=userLastMessages['get'](_0x597976);if(_0x1dd7a6){if(_0x1dd7a6[_0x5e8492(0x19d)]===_0x4af663)return!![];if(similarity(_0x1dd7a6[_0x5e8492(0x19d)],_0x4af663)>0.9)return!![];if(_0xa109f9-_0x1dd7a6['timestamp']<0x3e8)return!![];}return userLastMessages[_0x5e8492(0x185)](_0x597976,{'content':_0x4af663,'timestamp':_0xa109f9}),![];}function similarity(_0xd02c7a,_0x44cacc){const _0x41692b=_0x293a64,_0x2b1fd8=new Set(_0xd02c7a[_0x41692b(0x1b3)]()[_0x41692b(0x188)](/\s+/)),_0x55430f=new Set(_0x44cacc[_0x41692b(0x1b3)]()[_0x41692b(0x188)](/\s+/)),_0xf295e6=new Set([..._0x2b1fd8]['filter'](_0x4f6228=>_0x55430f[_0x41692b(0x173)](_0x4f6228)));return _0xf295e6[_0x41692b(0x1c7)]/Math['max'](_0x2b1fd8[_0x41692b(0x1c7)],_0x55430f[_0x41692b(0x1c7)]);}app[_0x293a64(0x1c0)](_0x293a64(0x16d),async(_0x3d29e7,_0x3df01a)=>{const _0x2b4c3e=_0x293a64,_0x39140f=await Message['find']()[_0x2b4c3e(0x1cf)]({'messageCount':-0x1})[_0x2b4c3e(0x17a)](0x64)['lean']();_0x3df01a[_0x2b4c3e(0x171)](_0x39140f[_0x2b4c3e(0x1a4)](_0x22ac0b=>({'username':_0x22ac0b[_0x2b4c3e(0x172)],'messageCount':_0x22ac0b[_0x2b4c3e(0x1cb)]})));}),app[_0x293a64(0x1c0)]('/previous-leaderboard',async(_0x33ee91,_0x50ce46)=>{const _0xc6fbc6=_0x293a64;try{const _0x4b6884=await PreviousLeaderboard[_0xc6fbc6(0x1bd)]()[_0xc6fbc6(0x1cf)]({'resetDate':-0x1})['lean']();if(!_0x4b6884)return _0x50ce46['json']({'entries':[],'resetDate':null,'weekNumber':null,'message':_0xc6fbc6(0x17e)});_0x50ce46[_0xc6fbc6(0x171)]({'entries':_0x4b6884[_0xc6fbc6(0x1c3)],'resetDate':_0x4b6884[_0xc6fbc6(0x1cd)],'weekNumber':_0x4b6884[_0xc6fbc6(0x1de)]});}catch(_0x24d5c8){_0x50ce46[_0xc6fbc6(0x175)](0x1f4)[_0xc6fbc6(0x171)]({'error':_0x24d5c8['message']});}}),app[_0x293a64(0x1c0)](_0x293a64(0x1bf),async(_0x410dc4,_0xfa3e09)=>{const _0x531af0=_0x293a64;try{const _0x176cb6=await isStreamerLive();_0xfa3e09[_0x531af0(0x171)]({'isLive':_0x176cb6});}catch(_0x3511c9){_0xfa3e09[_0x531af0(0x175)](0x1f4)[_0x531af0(0x171)]({'error':_0x3511c9['message']});}});async function isStreamerLive(){const _0x88dc4e=_0x293a64;try{const _0xb9160d=await _0x28f809(_0x88dc4e(0x1a5));if(!_0xb9160d['ok'])return![];const _0x98bdf9=await _0xb9160d[_0x88dc4e(0x171)]();return _0x98bdf9[_0x88dc4e(0x1ac)]&&_0x98bdf9[_0x88dc4e(0x1ac)][_0x88dc4e(0x18e)];}catch(_0x43e854){return console[_0x88dc4e(0x1d4)](_0x88dc4e(0x1ae),_0x43e854[_0x88dc4e(0x18a)]),![];}}async function pollKickMessages(){const _0x4e52fe=_0x293a64;try{const _0x2e3de4=await isStreamerLive();if(!_0x2e3de4){console[_0x4e52fe(0x17c)]('Streamer\x20is\x20offline\x20‚Äî\x20skipping\x20message\x20polling.');return;}const _0x47b80a='https://kick.com/api/v2/channels/'+CHANNEL_ID+_0x4e52fe(0x1b4),_0x1685db=await _0x28f809(_0x47b80a,{'headers':{'User-Agent':'Mozilla/5.0'}});if(!_0x1685db['ok']){console[_0x4e52fe(0x1d4)](_0x4e52fe(0x170),await _0x1685db['text']());return;}const _0x4aee3c=await _0x1685db[_0x4e52fe(0x171)](),_0x334290=(_0x4aee3c['data']?.['messages']||[])['sort']((_0x275797,_0x25ee6d)=>new Date(_0x275797[_0x4e52fe(0x1b0)])-new Date(_0x25ee6d[_0x4e52fe(0x1b0)]));for(const _0x489d26 of _0x334290){if(lastSeenMessageId===_0x489d26['id'])break;const _0x365618=_0x489d26[_0x4e52fe(0x197)]?.['username'],_0x4d84b3=_0x489d26['content'],_0x3c76bb=new Date(_0x489d26[_0x4e52fe(0x1b0)])[_0x4e52fe(0x1d1)]();if(!_0x365618||!_0x4d84b3)continue;if(IGNORED_USERS['includes'](_0x365618))continue;if(isSpamMessage(_0x365618,_0x4d84b3,_0x3c76bb))continue;await Message[_0x4e52fe(0x198)]({'username':_0x365618},{'$inc':{'messageCount':0x1}},{'upsert':!![]});}_0x334290[_0x4e52fe(0x1d8)]&&(lastSeenMessageId=_0x334290[_0x334290[_0x4e52fe(0x1d8)]-0x1]['id']);}catch(_0x2d780b){console[_0x4e52fe(0x1d4)](_0x4e52fe(0x180),_0x2d780b[_0x4e52fe(0x18a)]);}}((async()=>{const _0xa2224d=_0x293a64;try{const _0x3e821a=await _0x28f809('https://kick.com/api/v2/channels/'+CHANNEL_ID+_0xa2224d(0x1b4),{'headers':{'User-Agent':_0xa2224d(0x1a1)}}),_0x2b35e0=await _0x3e821a[_0xa2224d(0x171)](),_0x52e67f=_0x2b35e0['data']?.[_0xa2224d(0x1d7)]||[];_0x52e67f[_0xa2224d(0x1d8)]&&(lastSeenMessageId=_0x52e67f[_0x52e67f[_0xa2224d(0x1d8)]-0x1]['id']);}catch(_0x529ec8){}setInterval(pollKickMessages,0x3e8);})()),_0x23a26e[_0x293a64(0x1ce)](_0x293a64(0x1ba),async()=>{const _0x30c0b5=_0x293a64;try{const _0x16d3cc=new Date(),_0x45b57c=new Date(0x7e9,0x6,0x1,0x0,0x0,0x0,0x0);_0x16d3cc>=_0x45b57c&&(console[_0x30c0b5(0x17c)](_0x30c0b5(0x18c)),await resetLeaderboard(),await performRoll());}catch(_0x2148d6){console['error'](_0x30c0b5(0x1c5),_0x2148d6);}},{'timezone':_0x293a64(0x1b5)}),((()=>{const _0x4a819e=_0x293a64;nextRollTime=getNextRollTime(),console[_0x4a819e(0x17c)](_0x4a819e(0x192)+nextRollTime);})()),app[_0x293a64(0x17f)](_0x1f2435[_0x293a64(0x16c)](_0x293a64(0x19f))),app['use'](_0x1f2435[_0x293a64(0x171)]()),app[_0x293a64(0x19e)]('/roll-winner',async(_0x493d9,_0xb3526b)=>{const _0x5bb01d=_0x293a64;try{const {winner:_0x31567c,prize:_0xacd7d2,timestamp:_0x123977}=_0x493d9['body'],_0x360b01=new Roll({'winner':_0x31567c,'prize':_0xacd7d2,'timestamp':_0x123977?new Date(_0x123977):new Date(),'serverSeed':'manual','clientSeed':_0x5bb01d(0x1b2),'nonce':0x0,'hash':_0x5bb01d(0x1b2)});await _0x360b01['save'](),_0xb3526b['json']({'success':!![]});}catch(_0x434d97){_0xb3526b[_0x5bb01d(0x175)](0x1f4)['json']({'error':_0x434d97['message']});}}),app[_0x293a64(0x19e)](_0x293a64(0x1af),async(_0x339fb7,_0xb07e2b)=>{const _0x1d0edb=_0x293a64;try{const _0x3b3013=await Message[_0x1d0edb(0x1d2)]()[_0x1d0edb(0x1cf)]({'messageCount':-0x1})['limit'](0x64)[_0x1d0edb(0x1c8)](),_0x100dfd=new Date();_0x100dfd['setDate'](_0x100dfd[_0x1d0edb(0x1b8)]()+0x1);const _0xe3240b=new Date(_0x100dfd[_0x1d0edb(0x187)](),_0x100dfd[_0x1d0edb(0x174)](),_0x100dfd['getDate'](),0x0,0x0,0x0,0x0),_0x23e92a=new Date(),_0x35863c=_0x23e92a[_0x1d0edb(0x1d1)]()-_0xe3240b['getTime'](),_0x8fd632=Math[_0x1d0edb(0x17b)](_0x35863c/(0x7*0x18*0x3c*0x3c*0x3e8))+0x1;if(_0x3b3013[_0x1d0edb(0x1d8)]>0x0){const _0x1f0207=_0x3b3013['map']((_0x15b4f1,_0x1130a9)=>({'username':_0x15b4f1['username'],'messageCount':_0x15b4f1[_0x1d0edb(0x1cb)],'rank':_0x1130a9+0x1})),_0x2bd4a2=new PreviousLeaderboard({'entries':_0x1f0207,'resetDate':new Date(),'weekNumber':_0x8fd632});await _0x2bd4a2[_0x1d0edb(0x195)](),console[_0x1d0edb(0x17c)](_0x1d0edb(0x19a)+_0x1f0207['length']+_0x1d0edb(0x1c6)+_0x8fd632),_0xb07e2b[_0x1d0edb(0x171)]({'success':!![],'message':_0x1d0edb(0x177)+_0x1f0207['length']+_0x1d0edb(0x1ca)+_0x8fd632,'entries':_0x1f0207['slice'](0x0,0xa),'weekNumber':_0x8fd632});}else _0xb07e2b[_0x1d0edb(0x171)]({'success':![],'message':_0x1d0edb(0x1b6)});}catch(_0xaa9762){console[_0x1d0edb(0x1d4)](_0x1d0edb(0x184),_0xaa9762),_0xb07e2b[_0x1d0edb(0x175)](0x1f4)['json']({'error':_0xaa9762['message']});}}),app[_0x293a64(0x19c)](PORT,()=>console[_0x293a64(0x17c)](_0x293a64(0x18f)+PORT));
